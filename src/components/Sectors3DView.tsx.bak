import * as maplibregl from 'maplibre-gl';
import React from 'react';
import ReactMapGL, { NavigationControl } from 'react-map-gl/maplibre';
import type { StyleSpecification } from 'maplibre-gl';
import type { ViewState } from 'react-map-gl/maplibre';

import SectorsVoiceControl from '../voice/SectorsVoiceControl';
import Compass from './Compass';
import Polygons3D from './Polygons3D';

const mapStyle: StyleSpecification = {
  version: 8,
  name: 'Black',
  metadata: {},
  sources: {},
  layers: [{
    id: 'background',
    type: 'background',
    paint: {},
  }],
};

const style: React.CSSProperties = {
  width: '100%',
  height: 'calc(100vh - 1.9rem)',
  background: 'black',
};

export const initialViewState: Partial<ViewState> = {
  longitude: 9.27,
  latitude: 45.11,
  bearing: 0,
  zoom: 6.3,
  pitch: 40,
};

// Rough bounds of the area
const maxBounds: maplibregl.LngLatBoundsLike = [
  4, 11, 15, 70,
];

export default function Sectors3DView(): JSX.Element {
  return (
    <ReactMapGL
      id='map-3d'
      style={style}
      initialViewState={initialViewState}
      maxBounds={maxBounds}
      mapStyle={mapStyle}
      attributionControl={false}
      mapLib={maplibregl}
      antialias
      maxPitch={75}
      renderWorldCopies={false}
    >
      <Polygons3D />
      <NavigationControl visualizePitch={true} />
      <Compass/>
      <SectorsVoiceControl />
    </ReactMapGL>
  );
}
